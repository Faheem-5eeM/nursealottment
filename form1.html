<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NURSE REGISTRATION FORM</title>
    <link rel="stylesheet" href="form_NEW.css">
</head>
<body>
    <!-- <h1 class="header">Register Page</h1> -->
    <div class="container">
        <div class="header">
            <div class="header-content">
                <div class="header-image">
                    <img src="the-human-icon-and-logo-vector.jpg" alt="Nurse">
                </div>
                <div class="header-text">
                    <h1>New Nurse Registration Form</h1>
                    <p>Welcome to the team!</p>
                </div>
            </div>
        </div>

        <form id="nurseForm" class="form-container" method="post" autocomplete="off">
            <div class="form-group">
                <label for="name">Name</label>
                <input type="text" id="name" name="name" required>
            </div>

            <div class="form-group">
                <label for="contact">Contact Number</label>
                <input type="text" id="contact" name="contact" maxlength="13" required>
            </div>

            <div class="form-group">
                <label for="email">Email</label>
                <input type="email" id="email" name="email" required>
            </div>

            <div class="form-group">
                <label for="adhaar">Aadhaar Number</label>
                <input type="text" id="adhaar" name="adhaar" maxlength="12" pattern="\d{12}" required>
            </div>

            <div class="form-group">
                <label for="unique">Nurse Unique ID</label>
                <input type="text" id="unique" name="unique" placeholder="12345/ABC/2021" required>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="gender">Gender</label>
                    <select id="gender" name="gender" required>
                        <option value="" disabled selected hidden>Select Gender</option>
                        <option value="Female">Female</option>
                        <option value="Male">Male</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="age">Age</label>
                    <input type="number" id="age" name="age" required>
                </div>
            </div>

            <div class="form-group">
                <label for="medical_spec">Medical Specification</label>
                <input type="text" id="medical_spec" name="medical_spec" required>
            </div>

            <div class="form-group">
                <label for="location">Location</label>
                <input type="text" id="location" name="location" required>
            </div>

            <div class="form-group">
                <label for="languages">Languages Spoken</label>
                <input type="text" id="languages" name="languages" required>
            </div>

            <div class="form-group">
                <label for="experience">Experience (Years)</label>
                <input type="number" id="experience" name="experience" required>
            </div>

            <div class="form-group">
                <label for="preferences">Preferences</label>
                <textarea id="preferences" name="preferences" required></textarea>
            </div>

            <button type="submit">Submit</button>
        </form>

    <script>
        // Function to auto-prefix contact number with +91
        function autoPrefix() {
            const contactInput = document.getElementById("contact");
            const value = contactInput.value;

            // If the value doesn't start with '+91', prepend it
            if (!value.startsWith("+91")) {
                contactInput.value = "+91" + value.replace(/^(\+91)/, "");
            }

            // Limit the input to 13 characters: '+91' (3 chars) + 10 digits
            if (contactInput.value.length > 13) {
                contactInput.value = contactInput.value.slice(0, 13);
            }
        }

        //alert part
        // Add event listener for form submission
        document.getElementById('nurseForm').addEventListener('submit', async function (e) {
            e.preventDefault();  // Prevent default form submission

            // Auto-prefix contact number
            autoPrefix();

            // Gather form data
            const formData = new FormData(this);
            const data = {};
            formData.forEach((value, key) => {
                data[key] = value;
            });

            try {
                // Send the form data to the backend using fetch API
                const response = await fetch('/post', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data),
                });
                console.log("request:", JSON.stringify(data), " response: ", response);
                const responseData = await response.json();
                if (response.ok) {
                // Show success alert and reset form
                alert(responseData.message);  // Show success message
                document.getElementById('nurseForm').reset();  // Clear the form
            } else {
                // Show error alert
                alert(responseData.message || 'Something went wrong');  // Show error message
            }
        } catch (error) {
            // Handle any errors during the request
            console.error('Error submitting form:', error);
            alert(`Error: ${error.message}`);
        }
        });

        // Function to validate Aadhaar number
        // function validateAadhaar() {
        //     const aadhaarInput = document.getElementById("adhaar");
        //     const aadhaarValue = aadhaarInput.value;

        //     // Check if the Aadhaar number is exactly 12 digits
        //     if (!/^\d{12}$/.test(aadhaarValue)) {
        //         aadhaarInput.setCustomValidity("Aadhaar number must be exactly 12 digits.");
        //     } else {
        //         aadhaarInput.setCustomValidity(""); // Reset the custom validity if valid
        //     }
        // }

        // // Verhoeff Algorithm to validate Aadhaar Number
        // function isValidAadhaar(aadhaar) {
        //     const d = [
        //         [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        //         [1, 2, 3, 4, 5, 6, 7, 8, 9, 0],
        //         [2, 3, 4, 5, 6, 7, 8, 9, 0, 1],
        //         [3, 4, 5, 6, 7, 8, 9, 0, 1, 2],
        //         [4, 5, 6, 7, 8, 9, 0, 1, 2, 3],
        //         [5, 6, 7, 8, 9, 0, 1, 2, 3, 4],
        //         [6, 7, 8, 9, 0, 1, 2, 3, 4, 5],
        //         [7, 8, 9, 0, 1, 2, 3, 4, 5, 6],
        //         [8, 9, 0, 1, 2, 3, 4, 5, 6, 7],
        //         [9, 0, 1, 2, 3, 4, 5, 6, 7, 8]
        //     ];

        //     const p = [
        //         [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        //         [1, 2, 3, 4, 5, 6, 7, 8, 9, 0],
        //         [2, 3, 4, 5, 6, 7, 8, 9, 0, 1],
        //         [3, 4, 5, 6, 7, 8, 9, 0, 1, 2],
        //         [4, 5, 6, 7, 8, 9, 0, 1, 2, 3],
        //         [5, 6, 7, 8, 9, 0, 1, 2, 3, 4],
        //         [6, 7, 8, 9, 0, 1, 2, 3, 4, 5],
        //         [7, 8, 9, 0, 1, 2, 3, 4, 5, 6],
        //         [8, 9, 0, 1, 2, 3, 4, 5, 6, 7],
        //         [9, 0, 1, 2, 3, 4, 5, 6, 7, 8]
        //     ];

        //     const inv = [
        //         [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        //         [1, 0, 3, 2, 5, 4, 7, 6, 9, 8],
        //         [2, 3, 0, 1, 6, 7, 4, 5, 8, 9],
        //         [3, 2, 1, 0, 7, 6, 5, 4, 9, 8],
        //         [4, 5, 6, 7, 0, 1, 2, 3, 8, 9],
        //         [5, 4, 7, 6, 1, 0, 3, 2, 9, 8],
        //         [6, 7, 4, 5, 2, 3, 0, 1, 9, 8],
        //         [7, 6, 5, 4, 3, 2, 1, 0, 9, 8],
        //         [8, 9, 6, 7, 4, 5, 2, 3, 0, 1],
        //         [9, 8, 7, 6, 5, 4, 3, 2, 1, 0]
        //     ];

        //     const c = [
        //         [0, 1, 2, 3, 4, 5, 6, 7, 8, 9],
        //         [1, 2, 3, 4, 5, 6, 7, 8, 9, 0],
        //         [2, 3, 4, 5, 6, 7, 8, 9, 0, 1],
        //         [3, 4, 5, 6, 7, 8, 9, 0, 1, 2],
        //         [4, 5, 6, 7, 8, 9, 0, 1, 2, 3],
        //         [5, 6, 7, 8, 9, 0, 1, 2, 3, 4],
        //         [6, 7, 8, 9, 0, 1, 2, 3, 4, 5],
        //         [7, 8, 9, 0, 1, 2, 3, 4, 5, 6],
        //         [8, 9, 0, 1, 2, 3, 4, 5, 6, 7],
        //         [9, 0, 1, 2, 3, 4, 5, 6, 7, 8]
        //     ];

        //     const check = (str) => {
        //         let c0 = 0;
        //         for (let i = 0; i < 12; i++) {
        //             c0 = d[c0][p[i][parseInt(str.charAt(i))]];
        //         }
        //         return c0 === 0;
        //     };

        //     return check(aadhaar);
        // }

        // Submit handler function to validate form and submit
        function validateAndSubmitForm() {
            var form = document.querySelector('form');
            var aadhaarInput = document.getElementById('adhaar');

            if (isValidAadhaar(aadhaarInput.value)) {
                form.submit();
            } else {
                alert("Invalid Aadhaar number. Please check the format.");
            }
        }
    </script>
</body>
</html>
